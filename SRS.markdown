WASD Runner 요구사항 명세서
1. 개요
1.1 목적
브라우저에서 실행되는 콘솔 스타일 미니게임(WASD Runner)을 구현한다. 사용자는 WASD/화살표 키로 캐릭터를 이동해 코인을 획득하고 적을 피하며 점수를 올린다. 닉네임과 개인 최고 기록은 로컬 저장소에 보존한다.
1.2 범위
플랫폼: 최신 데스크톱 브라우저(Chrome, Edge, Firefox, Safari)
배포: GitHub Pages(Deploy from a branch)
구성: 단일 index.html(내장 JS) 기반 정적 사이트
1.3 이해관계자
사용자: 게임 플레이어
개발/운영: 기능 구현, 배포, 유지보수 담당
호스팅: GitHub Pages
1.4 용어
그리드/맵: 문자 기반 보드(가로 W, 세로 H)
플레이어: @
코인: o
적: E
벽(테두리): #
I-Frame(무적 시간): 피격 직후 일정 시간 동안 추가 피해를 무시하는 구간
2. 시스템 개요
렌더링: <pre> 텍스트 버퍼에 프레임을 조립해 출력
게임 루프: requestAnimationFrame + 내부 고정 틱(70ms) 업데이트
입력 처리: 물리키 코드(e.code: KeyW/A/S/D, Arrow*) 기반 → 한글 IME 상태에서도 동작
저장소: localStorage에 닉네임 및 닉네임별 최고 점수 보존
배포 구조: 레포 루트 또는 /docs 경로에 index.html 배치
3. 기능 요구사항 (Functional Requirements)
FR-01 맵 렌더링
30×12(기본값) 텍스트 맵을 렌더링한다.
맵의 테두리는 #로 채운다.
상단 2줄 상태표시:
1행: 조작법 WASD/Arrow, Q: 종료, R: 재시작
2행: Player: <닉네임> Lives: <잔기>[ (무적)] Score: <점수> Best: <개인최고>
FR-02 플레이어 이동
입력: KeyW/A/S/D 및 ArrowUp/Left/Down/Right.
벽(#) 영역으로는 이동 불가.
이동 직후 즉시 1회 충돌 판정 실행.
FR-03 적/코인 스폰
초기 스폰: 적 3, 코인 5 (플레이어/벽과 겹치면 재추첨).
적은 매 틱마다 50% 추적 / 50% 랜덤 보행.
코인 획득 시 점수 +10, 60% 확률로 신규 코인 1개 스폰.
누적 점수가 100의 배수일 때 25% 확률로 적 1마리 추가 스폰.
FR-04 충돌 판정
코인: 플레이어와 좌표 일치 시 획득 및 제거.
적: 플레이어와 좌표 일치 시 피격 처리.
잔기(lives) 1 감소(최소 0으로 클램프)
플레이어를 맵 중앙으로 리스폰
무적 타이머(HIT_IFRAME_MS=800ms) 시작
FR-05 무적(I-Frame)
피격 직후 HIT_IFRAME_MS 동안 추가 피격 무시.
무적 중에는 상태표시에 (무적) 표시.
무적 시간은 프레임 경과시간 dt로 감소(0 미만으로 내려가지 않음).
FR-06 게임 종료/재시작
잔기가 0이 되면 running=false로 전환, 루프 정지.
게임오버 화면 출력: ===== GAME OVER =====, 최종 점수, 개인 최고 점수, R: 재시작, Q: 종료.
R 키 입력 시 상태 초기화 후 즉시 재시작.
FR-07 닉네임 입력/저장
첫 실행 시 prompt()로 닉네임(최대 16자) 입력. 비어 있으면 Player.
닉네임은 localStorage에 저장, 다음 실행 시 재사용.
FR-08 개인 최고 기록 저장/표시
닉네임별 최고 점수를 localStorage로 보존.
게임오버 시 현재 점수가 기존 최고보다 크면 갱신.
상단 상태표시와 게임오버 화면에 최고 점수를 표시.
FR-09 포커스/입력 보장
<pre id="screen">에 tabindex="0" 부여 및 자동 .focus() 호출.
클릭 시 포커스를 재획득하여 입력을 보장.
4. 데이터 요구사항
4.1 로컬 저장 키
닉네임: game_test_nick → 문자열
개인 최고 점수: game_test_best:<닉네임> → 정수 문자열(기본 "0")
4.2 데이터 제약
닉네임 길이 ≤ 16자
점수: 0 이상 정수(JS Number 안전 범위 내)
5. 비기능 요구사항 (Non-Functional)
NFR-01 성능
렌더링은 requestAnimationFrame, 로직은 고정 틱 70ms.
일반 노트북 환경에서 1분 이상 플레이 시 눈에 띄는 입력 지연/프레임 드랍이 없어야 한다.
NFR-02 호환성
최신 데스크톱 브라우저(최근 2개 주요 버전) 지원.
모바일 브라우저는 권장 대상 아님(추후 확장 고려).
NFR-03 접근성/국제화
물리 키 코드(e.code) 사용으로 IME 상태와 무관하게 입력 인식.
텍스트 대비 확보(다크 배경 + 밝은 전경), 모노스페이스 폰트 사용.
NFR-04 보안/프라이버시
외부 네트워크 통신 없음.
쿠키/추적 스크립트 미사용, 데이터는 클라이언트 localStorage에만 저장.
NFR-05 배포/운영
GitHub Pages: Deploy from a branch
index.html이 레포 루트면 /(root), docs/면 /docs 지정.
캐시 반영 지연 가능 → 강력 새로고침 또는 쿼리버전(?v=...) 권장.
6. UI/UX 요구사항
상단 2행 상태표시는 항상 표시.
맵 심볼: 플레이어 @, 적 E, 코인 o, 벽/테두리 #, 빈칸 공백.
피격 시 즉시 리스폰, (무적) 표기로 피드백.
게임오버 화면에 안내 문구와 조작 키(R, Q) 표기.
7. 예외/오류 처리
localStorage 접근 불가(시크릿 모드 등)
try/catch로 예외 흡수, 닉네임은 메모리 유지, 최고 점수는 0 취급.
prompt() 취소/공백 입력
기본 닉네임 Player.
포커스 이탈로 입력 불가
클릭으로 포커스 재획득.
8. 수용 기준 (Acceptance Criteria)
ID	시나리오	절차	기대 결과
AC-01	이동/벽 충돌	WASD/Arrow로 벽 방향 이동	벽(#) 통과 불가
AC-02	코인 획득	코인 위치로 이동	점수 +10, 코인 제거, 60% 확률로 코인 재스폰
AC-03	피격/무적	적과 겹침	잔기 1 감소(최소 0), 중앙 리스폰, (무적) 표시
AC-04	무적 해제	피격 후 0.8초 경과	(무적) 표시 해제, 피격 가능
AC-05	게임오버	잔기 0 도달	루프 정지, GAME OVER 화면, R/Q 안내
AC-06	재시작	R 입력	초기화 후 즉시 재시작
AC-07	닉네임 저장	최초 닉 입력 후 새로고침	동일 닉네임 유지
AC-08	최고 기록 저장	기존 최고 100, 이번 120	최고 120으로 갱신 및 표시
9. 테스트 케이스(요약)
TC-IME-01: 한글 입력 상태에서 WASD/Arrow 입력 → 정상 이동
TC-IFRAME-01: 피격 직후 0.8초 내 중복 피격 발생 시 → 잔기 추가 감소 없음
TC-STORE-01: localStorage 비가용 환경 → 에러 없이 플레이, 최고 점수 0 표시
TC-PERF-01: 1분 플레이 → 프레임 드랍/입력 지연 체감 없음
TC-EDGE-01: 점수 100, 200… 도달 시 → 25% 확률로 적 추가 스폰 확인
10. 구성/배포
파일
index.html 1개(내장 스크립트)
Pages 설정
Source: Deploy from a branch
Branch: main
Folder: /(root) 또는 /docs (실제 index.html 위치와 일치)
11. 변경/추가 요구사항(향후)
모바일 터치 UI(가상 패드) 지원
사운드 효과(코인, 피격, 게임오버)
난이도 선택(틱 간격, 스폰율 조정)
시드 고정/리플레이
무적 시 시각 효과(깜빡임)
글로벌 리더보드(백엔드 필요, 현 범위 외)
12. 비범위(Out of Scope)
서버 저장/인증/멀티플레이
반응형 모바일 최적화(현 버전)
네이티브 C++ 콘솔 빌드/배포(웹 버전과 별개)
13. 현재 파라미터(기본값)
W = 30, H = 12
TICK_MS = 70
HIT_IFRAME_MS = 800
초기 적 = 3, 코인 = 5
점수 100의 배수 도달 시 25% 확률로 적 +1
14. 구현 체크리스트
 입력 처리: e.code로 WASD/Arrow 인식(IME 무관)
 포커스 보장: <pre id="screen" tabindex="0"> + 초기 .focus() + 클릭 포커스
 맵 렌더링: 테두리 #, 내부 공백, 상단 2행 상태표시
 이동 직후 충돌: movePlayerBy() 끝에서 collide() 1회 실행
 코인 로직: +10 점수, 60% 확률 재스폰
 적 AI: 50% 추적 / 50% 랜덤 보행
 무적 처리: 피격 시 hitCooldown = 800ms, 루프에서 hitCooldown = max(0, hitCooldown - dt)
 라이프 클램프: lives = max(0, lives - 1) (음수 불가)
 게임오버: running=false 또는 lives<=0에서 종료 화면 출력
 재시작: R 키로 상태 초기화 + 루프 재개
 닉네임 저장: game_test_nick 키로 보존
 최고 기록 저장: game_test_best:<닉네임> 갱신/표시
 배포 설정: Pages main + /(root) 또는 /docs (경로 일치)
 캐시 무효화 확인: 강력 새로고침 또는 쿼리버전(?v=…)로 갱신 확인
추가 요구: 벽에 닿으면 사망 처리(잔기 감소), 적은 일정 점수 이상부터만 움직임.